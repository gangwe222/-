local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Event = ReplicatedStorage:WaitForChild("ASISU1")

local running = false -- í† ê¸€ ìƒíƒœ ì €ì¥
local loopThread = nil -- í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ë£¨í”„ ì‘ì—… ì €ì¥

local function shuffle(tbl)
	local newTbl = {}
	for i, v in ipairs(tbl) do
		newTbl[i] = v
	end
	for i = #newTbl, 2, -1 do
		local j = math.random(1, i)
		newTbl[i], newTbl[j] = newTbl[j], newTbl[i]
	end
	return newTbl
end

local function startLoop()
	if loopThread then
		-- ì´ë¯¸ ì‹¤í–‰ì¤‘ì´ë©´ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
		return
	end
	
	loopThread = task.spawn(function()
		while running do
			local players = Players:GetPlayers()
			local shuffled = shuffle(players)

			for _, player in ipairs(shuffled) do
				if not running then break end

				local args = {
					player.Name,
					-999999999999999999999999999999999999999999999000000000000000000099
				}
				Event:FireServer(unpack(args))
				print("ì „ì†¡ë¨: ", player.Name)
				task.wait(0.01)
			end

			task.wait(0.35)
		end
		loopThread = nil -- ì¢…ë£Œ ì‹œì ì— ì´ˆê¸°í™”
	end)
end

MainTab:CreateToggle({
	Name = "ğŸ’£ ë°˜ë³µ ëˆ í…ŒëŸ¬ (0.35ì´ˆ)",
	CurrentValue = false,
	Callback = function(Value)
		running = Value
		if running then
			startLoop()
		end
	end
})
