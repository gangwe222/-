local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Event = ReplicatedStorage:WaitForChild("ASISU1")

local running = false -- 토글 상태 저장
local loopThread = nil -- 현재 실행중인 루프 작업 저장

local function shuffle(tbl)
	local newTbl = {}
	for i, v in ipairs(tbl) do
		newTbl[i] = v
	end
	for i = #newTbl, 2, -1 do
		local j = math.random(1, i)
		newTbl[i], newTbl[j] = newTbl[j], newTbl[i]
	end
	return newTbl
end

local function startLoop()
	if loopThread then
		-- 이미 실행중이면 중복 실행 방지
		return
	end
	
	loopThread = task.spawn(function()
		while running do
			local players = Players:GetPlayers()
			local shuffled = shuffle(players)

			for _, player in ipairs(shuffled) do
				if not running then break end

				local args = {
					player.Name,
					-999999999999999999999999999999999999999999999000000000000000000099
				}
				Event:FireServer(unpack(args))
				print("전송됨: ", player.Name)
				task.wait(0.01)
			end

			task.wait(0.35)
		end
		loopThread = nil -- 종료 시점에 초기화
	end)
end

MainTab:CreateToggle({
	Name = "💣 반복 돈 테러 (0.35초)",
	CurrentValue = false,
	Callback = function(Value)
		running = Value
		if running then
			startLoop()
		end
	end
})
